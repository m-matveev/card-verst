popupWindow=null;key="val";function showOAuthUser(){$.ajax({url:"/oauth/user/view.htm",dataType:"json",cache:false,success:function(response){if(!response.authenticated){return}var ownerLogin=$("#additionalParameters_ownerLogin");$(ownerLogin).val(response.login);$(ownerLogin).data(key,response.login);$("a[class^='oauth '][class$=' selected']").removeClass("selected");$("a[id='oauth-"+response.providerName+"']").addClass("selected")}})}function removeOAuthUser(clear){$.ajax({url:"/oauth/user/remove.htm",dataType:"json",cache:false,success:function(response){if(!response.isSuccessful){return}var ownerLogin=$("#additionalParameters_ownerLogin");if(clear){$(ownerLogin).val("")}$("a[id^='oauth-'][class$=' selected']").removeClass("selected");$(ownerLogin).removeData(key)}})}$(function(){var ownerLogin=$("#additionalParameters_ownerLogin");$(ownerLogin).on("input change keyup",function(){var savedValue=$(this).data(key);if(typeof savedValue!="undefined"&&savedValue.length!=0&&savedValue!=$(this).val().trim()){removeOAuthUser(false)}});$("a[id^='oauth-']").click(function(){if($(this).hasClass("selected")){return false}removeOAuthUser(true);if(popupWindow&&!popupWindow.closed){popupWindow.close()}var w,h;if($(this).hasClass("vk")){w=660;h=388}else{if($(this).hasClass("facebook")){w=650;h=280}else{if($(this).hasClass("esia")){w=450;h=600}else{w=450;h=450}}}var left=(screen.width)?(screen.width-w)/2:0;var top=(screen.height)?(screen.height-h)/2:0;var settings="height="+h+",width="+w+",top="+top+",left="+left+",scrollbars=yes,resizable=yes,dependent=yes";popupWindow=window.open($(this).attr("href"),"oauthAuthorization",settings);popupWindow.focus();return false})});